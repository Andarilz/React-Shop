import React, {Component} from 'react'
import {connect}from 'react-redux'
import {fetchPhones, loadMorePhones, addPhoneToBasket, fetchCategories} from 'actions'
import {getPhones} from 'Selectors'
import * as R from 'ramda'
import {Link} from 'react-router-dom'
import Layout from 'containers/layout'


class Phones extends Component{

componentDidMount() {
  this.props.fetchPhones() //активируем функцию получения моковых данных
  this.props.fetchCategories() //активируем функцию с категориями
}

  renderPhone(phone, index){
  const shortsDescription = `${R.take(60, phone.description)}...`
    const {addPhoneToBasket} = this.props
    return (
      <div className='col-sm-4 col-md-4 book-list' key={index}>
        <div className='thumbnail'>
          <img
            src={phone.image}
            alt={phone.name}
            className='img-thumbnail'
          />
          <div className="caption">
            <h4 className='pull-right'>${phone.price}</h4>
            <h4>
              <Link to={`/phones/${phone.id}`}>
              {phone.name}
              </Link>
            </h4>
            <p>{shortsDescription}</p>
            <p className='itemButton'>
              <button
                className='btn btn-primary'
                onClick={() => addPhoneToBasket(phone.id)}
              >BUY NOW</button>
              <Link
                to={`/phones/${phone.id}`}
                className='btn btn-default'
              >
                More info
              </Link>
            </p>
          </div>
        </div>
      </div>
    )
  }

  render(){
  const {phones, loadMorePhones} = this.props

        return(
            <Layout>
              <div className='books row'>
                {phones.map((phone,index) => this.renderPhone(phone, index))}
              </div>
              <div className="row">
                <div className="col-md-12">
                  <button
                  onClick={loadMorePhones}
                  className='pull-right btn btn-primary'
                  >
                    Load More
                  </button>
                </div>
              </div>
            </Layout>
        )
    }
}

const mapDispatchToProps = {
  fetchPhones, //из экшена берем и в пропсы передаем
  loadMorePhones, //из экшена берем и в пропсы передаем
  addPhoneToBasket,
  fetchCategories
}

const mapStateToProps = (state, ownProps) => ({
  phones: getPhones(state, ownProps)//из Selector берем и в пропсы передаем
})


export default connect(mapStateToProps, mapDispatchToProps)(Phones) //активируем моковые перебранные значения для работы редьюсеров


























//
// import React, {Component} from 'react'
// import {connect}from 'react-redux'
// import {fetchPhones, loadMorePhones, addPhoneToBasket} from 'actions'
// import {getPhones} from '../../Selectors'
// import * as R from 'ramda'
// import {Link} from 'react-router-dom'
// import Layout from 'containers/layout'
//
//
// class Phones extends Component{
//
//   componentDidMount() {
//     this.props.fetchPhones() //активируем функцию получения моковых данных
//   }
//
//   renderPhone(phone, index){
//     const shortsDescription = `${R.take(60, phone.description)}...`
//     const {addPhoneToBasket} = this.props
//     return (
//       <div className='col-sm-4 col-md-4 book-list' key={index}>
//         <div className='thumbnail'>
//           <img
//             src={phone.image}
//             alt={phone.name}
//             className='img-thumbnail'
//           />
//           <div className="caption">
//             <h4 className='pull-right'>${phone.price}</h4>
//             <h4>
//               <Link to={`/phones/${phone.id}`}>
//                 {phone.name}
//               </Link>
//             </h4>
//             <p>{shortsDescription}</p>
//             <p className='itemButton'>
//               <button
//                 className='btn btn-primary'
//                 onClick={() => addPhoneToBasket(phone.id)}
//               >BUY NOW</button>
//               <Link
//                 to={`/phones/${phone.id}`}
//                 className='btn btn-default'
//               >
//                 More info
//               </Link>
//             </p>
//           </div>
//         </div>
//       </div>
//     )
//   }
//
//   render(){
//     const {phones, loadMorePhones} = this.props
//
//     return(
//       <Layout>
//         <div className='books row'>
//           {phones.map((phone,index) => this.renderPhone(phone, index))}
//         </div>
//         <div className="row">
//           <div className="col-md-12">
//             <button
//               onClick={loadMorePhones}
//               className='pull-right btn btn-primary'
//             >
//               Load More
//             </button>
//           </div>
//         </div>
//       </Layout>
//     )
//   }
// }
//
// const mapDispatchToProps = {
//   fetchPhones, //из экшена берем и в пропсы передаем
//   loadMorePhones, //из экшена берем и в пропсы передаем
//   addPhoneToBasket
// }
//
// const mapStateToProps = state => ({
//   phones: getPhones(state)//из Selector берем и в пропсы передаем
// })
//
//
// export default connect(mapStateToProps, mapDispatchToProps)(Phones) //активируем моковые перебранные значения для работы редьюсеров
//






